<!-- Add this inside your HTML body, before </body> -->
<div id="chatbox">
  <div id="chatlogs"></div>
  <input type="text" id="chatinput" placeholder="Say something..." />
  <button id="sendBtn">Send</button>
</div>

<!-- Styles for chatbox -->
<style>
  #chatbox {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 300px;
    max-height: 400px;
    background: #fff;
    border: 2px solid #0a3d2b;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    font-family: 'Pacifico', cursive;
    font-size: 0.9em;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(10, 61, 43, 0.4);
  }

  #chatlogs {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
  }

  #chatinput {
    border: none;
    border-top: 1px solid #0a3d2b;
    padding: 10px;
    font-family: 'Pacifico', cursive;
  }

  #sendBtn {
    background-color: #0a3d2b;
    color: #fff;
    border: none;
    padding: 10px;
    cursor: pointer;
    font-family: 'Pacifico', cursive;
  }

  #sendBtn:hover {
    background-color: #5cdb95;
    color: #000;
  }
</style>

<script>
  const chatlogs = document.getElementById('chatlogs');
  const chatinput = document.getElementById('chatinput');
  const sendBtn = document.getElementById('sendBtn');

  const wittyResponses = {
    greetings: [
      "Well, hello there! Fancy meeting you here.",
      "Greetings, mortal! How can I assist your noble quest?",
      "Oh, it's you again. What do you want this time?",
      "Hello! Don't mind me, just pretending to be busy."
    ],
    helpRequests: [
      "Help? You're asking me? I thought you'd never ask. Here's a tip: try clicking on a room.",
      "Assistance? Sorry, I'm only programmed for snark today. Maybe check the lore instead?",
      "Help? I’d help if I knew how to fix your broken questions. Try asking nicely.",
      "You want help? Well, I’m a chatbot, not a butler, but I’ll try my best."
    ],
    default: [
      "I'm not sure what you mean, but I do love a good tea party.",
      "Speak up! Can't hear your muffled cries over the sound of my wit.",
      "Hmm, interesting. Tell me more or just say hi again.",
      "I'm listening... or am I? Hard to tell with all this cryptic charm."
    ]
  };

  function getRandomResponse(type) {
    const responses = wittyResponses[type] || wittyResponses['default'];
    return responses[Math.floor(Math.random() * responses.length)];
  }

  function speak(text) {
    const utterance = new SpeechSynthesisUtterance(text);
    // Set British accent if available
    utterance.lang = 'en-GB';
    window.speechSynthesis.speak(utterance);
  }

  function addMessage(text, sender='bot') {
    const msg = document.createElement('div');
    msg.textContent = text;
    msg.style.margin = '5px 0';
    msg.style.padding = '5px 10px';
    msg.style.borderRadius = '10px';
    msg.style.backgroundColor = sender==='bot' ? '#a7ffeb' : '#fff';
    msg.style.alignSelf = sender==='bot' ? 'flex-start' : 'flex-end';
    chatlogs.appendChild(msg);
    chatlogs.scrollTop = chatlogs.scrollHeight;
  }

  // Handle user input
  sendBtn.addEventListener('click', () => {
    const userText = chatinput.value.trim();
    if (!userText) return;
    addMessage(userText, 'user');
    chatinput.value = '';

    // Check for keywords
    const lowerText = userText.toLowerCase();
    if (lowerText.includes('hi') || lowerText.includes('hello')) {
      const reply = getRandomResponse('greetings');
      addMessage(reply);
      speak(reply);
    } else if (lowerText.includes('how are you')) {
      const reply = "I'm just a bunch of code, but I'm feeling quite witty today.";
      addMessage(reply);
      speak(reply);
    } else if (lowerText.includes('help') || lowerText.includes('assistance') || lowerText.includes('can you help me')) {
      const reply = getRandomResponse('helpRequests');
      addMessage(reply);
      speak(reply);
    } else {
      const reply = getRandomResponse('default');
      addMessage(reply);
      speak(reply);
    }
  });

  // Optional: Press Enter to send
  chatinput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      sendBtn.click();
    }
  });
  
  // Trigger responses with room clicks
  const roomElements = document.querySelectorAll('.room');
  roomElements.forEach(room => {
    room.addEventListener('click', () => {
      const roomName = room.dataset.room;
      const reply = `Ah, stepping into the ${rooms[roomName].title}. Cheerio!`;
      addMessage(reply);
      speak(reply);
    });
  });
</script>
